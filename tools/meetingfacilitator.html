<!DOCTYPE html>
<html lang="en">

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Meeting Facilitator</title>

    <link href="https://cdn.jsdelivr.net/npm/daisyui@4.12.24/dist/full.min.css" rel="stylesheet" type="text/css" />
    <script defer src="/nav.js"></script>
</head>

<body class="bg-gray-100">

    <div id="nav-container"></div>

    <!-- Controls -->
    <main class="flex flex-col items-center justify-center min-h-screen text-center p-6 space-y-6">

        <!-- Saved Items & Actions -->
        <div class="flex gap-3">
            <select id="saved-items" class="select select-bordered w-52" onchange="loadSavedItem()">
                <option value="">Select Saved Timer</option>
            </select>
            <div class="btn-group">
                <button class="btn btn-secondary" onclick="addNewItem()">Create</button>
                <button id="save-btn" class="btn btn-accent" onclick="saveItem()" disabled>Save</button>
                <button id="delete-btn" class="btn btn-error" onclick="deleteItem()" disabled>Delete</button>
            </div>
        </div>

        <!-- Title -->
        <div class="card w-full max-w-md bg-white shadow p-4">
            <h1 contenteditable="true" id="title" class="text-3xl font-bold bg-base-200 p-2 rounded">Meeting Timer</h1>
            <p id="description" contenteditable="true" class="border p-3 bg-base-100 mt-2 rounded shadow-sm"
                onblur="formatDescription()">This is the page for the meeting timer</p>
        </div>

        <!-- Timer Setup -->
        <div id="timer-setup" class="card w-full max-w-md bg-white shadow p-4 space-y-3">
            <label for="minutes" class="label font-semibold">Set Timer (minutes):</label>
            <div class="flex items-center gap-3">
                <input type="number" id="minutes" class="input input-bordered w-24 text-center" min="1" value="1">
                <button class="btn btn-primary flex-1" onclick="startTimer()">Start Timer</button>
            </div>
        </div>

        <!-- Running Timer -->
        <div id="timer-running" class="hidden card w-full max-w-md bg-white shadow p-6 text-center">
            <h1 id="timer-display" class="text-5xl font-bold text-primary">00:00</h1>
            <button class="btn btn-error mt-4 w-full" onclick="cancelTimer()">Cancel</button>
        </div>

        <!-- Progress Bar -->
        <progress id="progress-bar" class="progress progress-primary w-full max-w-md h-4 mt-4" value="0" max="100"></progress>

        <!-- Timer Completion Message -->
        <div id="timer-complete" class="hidden alert alert-success shadow-lg max-w-md">
            <span>Timer Complete! ðŸŽ‰</span>
        </div>

    </main>

    <script>
        let countdown, totalTime, remainingTime;

        function startTimer() {
            totalTime = parseInt(document.getElementById("minutes").value) * 60;
            if (totalTime <= 0) return;

            remainingTime = totalTime;
            document.getElementById("timer-setup").classList.add("hidden");
            document.getElementById("timer-running").classList.remove("hidden");
            document.getElementById("timer-complete").classList.add("hidden");
            updateTimerDisplay();

            countdown = setInterval(() => {
                if (remainingTime <= 0) {
                    clearInterval(countdown);
                    document.getElementById("timer-running").classList.add("hidden");
                    document.getElementById("timer-complete").classList.remove("hidden");
                    return;
                }
                remainingTime--;
                updateTimerDisplay();
                document.getElementById("progress-bar").value = ((totalTime - remainingTime) / totalTime) * 100;
            }, 1000);
        }

        function cancelTimer() {
            clearInterval(countdown);
            document.getElementById("timer-setup").classList.remove("hidden");
            document.getElementById("timer-running").classList.add("hidden");
            document.getElementById("progress-bar").value = 0;
            document.getElementById("timer-complete").classList.add("hidden");
        }

        function updateTimerDisplay() {
            const minutes = Math.floor(remainingTime / 60);
            const seconds = remainingTime % 60;
            document.getElementById("timer-display").textContent =
                `${String(minutes).padStart(2, '0')}:${String(seconds).padStart(2, '0')}`;
        }
    </script>

</body>

</html>
